<!doctype html><html lang=en-us><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"Website","@id":"https:\/\/www.andymcdonald.scot\/","author":{"@type":"Person","name":"Andy McDonald","image":"https://www.andymcdonald.scot/images/andy2.png"},"name":"Andy McDonald","description":"Adding lithology information to a well log plot can enhance a petrophysical or geological interpretation. See how to display this data on a log plot using Python\u0026rsquo;s matplotlib library","url":"https:\/\/www.andymcdonald.scot\/blog\/2021\/2021-02-07-displaying-lithology-on-log-plots-using-python\/","keywords":"[]"}</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.98.0 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content="Andy McDonald"><meta name=keywords content><meta name=description content="Adding lithology information to a well log plot can enhance a petrophysical or geological interpretation. See how to display this data on a log plot using Python&rsquo;s matplotlib library"><meta property="og:description" content="Adding lithology information to a well log plot can enhance a petrophysical or geological interpretation. See how to display this data on a log plot using Python&rsquo;s matplotlib library"><meta property="og:type" content="article"><meta property="og:title" content="Displaying Lithology Data on a Well Log Plot Using Python"><meta name=twitter:title content="Displaying Lithology Data on a Well Log Plot Using Python"><meta property="og:url" content="https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/"><meta property="twitter:url" content="https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/"><meta property="og:site_name" content="Andy McDonald"><meta property="og:description" content="Adding lithology information to a well log plot can enhance a petrophysical or geological interpretation. See how to display this data on a log plot using Python&rsquo;s matplotlib library"><meta name=twitter:description content="Adding lithology information to a well log plot can enhance a petrophysical or geological interpretation. See how to display this data on a log plot using Python&rsquo;s matplotlib library"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2021-02-07T00:00:00"><meta property="article:modified_time" content="2021-02-07T00:00:00"><meta property="article:section" content="Python"><meta property="article:section" content="Well Log Data"><meta property="article:tag" content="petrophysics"><meta property="article:tag" content="python"><meta property="article:tag" content="lithology"><meta name=twitter:card content="summary"><meta property="og:image" content="https://www.andymcdonald.scot/images/andy2.png"><meta property="twitter:image" content="https://www.andymcdonald.scot/images/andy2.png"><title>Displaying Lithology Data on a Well Log Plot Using Python</title><link rel=icon href=https://www.andymcdonald.scot/favicon.png><link rel=canonical href=https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://www.andymcdonald.scot/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css></head><body><div id=blog><header id=header data-behavior=2><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=https://www.andymcdonald.scot/ aria-label="Go to homepage">Andy McDonald</a></div><a class=header-right-picture href=https://www.andymcdonald.scot/#about aria-label="Open the link: /#about"><img class=header-picture src=https://www.andymcdonald.scot/images/andy2.png alt="Author's picture"></a></header><nav id=sidebar data-behavior=2><div class=sidebar-container><div class=sidebar-profile><a href=https://www.andymcdonald.scot/#about aria-label="Read more about the author"><img class=sidebar-profile-picture src=https://www.andymcdonald.scot/images/andy2.png alt="Author's picture"></a><h4 class=sidebar-profile-name>Andy McDonald</h4><h5 class=sidebar-profile-bio>Super bio with markdown support <strong>COOL</strong></h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/about title=About><i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden=true></i>
<span class=sidebar-button-desc>About</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/blog title=Blog><i class="sidebar-button-icon fas fa-lg fa-server" aria-hidden=true></i>
<span class=sidebar-button-desc>Blog</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/published_work title=Publications><i class="sidebar-button-icon fas fa-lg fa-book" aria-hidden=true></i>
<span class=sidebar-button-desc>Publications</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/categories title=Categories><i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden=true></i>
<span class=sidebar-button-desc>Categories</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>Tags</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/andymcdgeo target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.linkedin.com/in/andymcdonaldgeo/ target=_blank rel=noopener title=LinkedIn><i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden=true></i>
<span class=sidebar-button-desc>LinkedIn</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://medium.com/@andymcdonaldgeo target=_blank rel=noopener title=Medium><i class="sidebar-button-icon fab fa-lg fa-medium" aria-hidden=true></i>
<span class=sidebar-button-desc>Medium</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.youtube.com/c/AndyMcDonald42 target=_blank rel=noopener title=YouTube><i class="sidebar-button-icon fab fa-lg fa-youtube" aria-hidden=true></i>
<span class=sidebar-button-desc>YouTube</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div></nav><div id=main data-behavior=2 class=hasCoverMetaIn><article class=post id=top><div class="post-header main-content-wrap text-left"><h1 class=post-title>Displaying Lithology Data on a Well Log Plot Using Python</h1><div class="postShorten-meta post-meta"><time datetime=2021-02-07T00:00:00Z>February 7, 2021</time>
<span>in</span>
<a class=category-link href=https://www.andymcdonald.scot/categories/python>Python</a>,
<a class=category-link href=https://www.andymcdonald.scot/categories/well-log-data>Well Log Data</a></div></div><div class="post-content markdown"><div class=main-content-wrap><p>Adding lithology information to a well log plot can enhance a petrophysical or geological interpretation. It can be used to understand why some log responses may behave the way they do. This data may have been sourced from a previous mineralogical interpretation or from mud logs.</p><p>In my previous article: <a href=https://towardsdatascience.com/enhancing-visualization-of-well-logs-with-plot-fills-72d9dcd10c1b>Enhancing Visualization of Well Logs With Plot Fills</a>, we saw: how to apply fixed color fill between a curve and the edge of a track, how to apply a density-neutron crossover fill and how to apply a variable fill based upon the value of curve being plotted.</p><p>In this article will cover how to use a variable fill to apply not only a color to our plot, but also a hatching. Using these two options allows us to generate lithological fill.</p><p>This article forms part of my Python & Petrophysics series. The full series can be found <a href=http://andymcdonald.scot/python-and-petrophysics>here</a>. For the examples below you can find my Jupyter Notebook and dataset on my GitHub repository at <a href=https://github.com/andymcdgeo/Petrophysics-Python-Series>here</a></p><p>To follow along, the Jupyter Notebook can be found at the link above and the data file for this article can be found in the <a href=https://github.com/andymcdgeo/Petrophysics-Python-Series/tree/master/Data>Data subfolder</a> of the Python & Petrophysics repository.</p><h2 id=setting-up--displaying-lithology-fills-on-a-well-log-plot>Setting Up & Displaying Lithology Fills on a Well Log Plot</h2><h3 id=setting-up-the-libraries>Setting up the Libraries</h3><p>The first step is to bring in the libraries we will be working with for this article. We will be using just two libraries: <a href=https://pandas.pydata.org/>pandas</a> and <a href=https://matplotlib.org/>matplotlib</a>. This will allow us to load our data to a dataframe and display it on a plot.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span></code></pre></div><h3 id=loading-the-data>Loading the Data</h3><p>The dataset we will be using for this article comes from a recent Machine Learning competition for lithology prediction that was run by Xeek and FORCE (<a href=https://xeek.ai/challenges/force-well-logs/overview>https://xeek.ai/challenges/force-well-logs/overview</a>). The objective of the competition was to predict lithology from a dataset consisting 98 training wells each with varying degrees of log completeness. The objective was to predict lithofacies based on the log measurements. To download the file, navigate to the Data section of the link above.</p><p>The data can be loaded using pd.read_csv(). As this is quite a large dataset, we will use a single well from it to work with and we will also take just the curves (columns) we need. We can do that by taking a subset of the data like so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>alldata <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;Data/xeek_train_subset.csv&#39;</span>)
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> alldata<span style=color:#f92672>.</span>loc[alldata[<span style=color:#e6db74>&#39;WELL&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;16/10-1&#39;</span>][[<span style=color:#e6db74>&#39;DEPTH_MD&#39;</span>, <span style=color:#e6db74>&#39;GR&#39;</span>, <span style=color:#e6db74>&#39;RHOB&#39;</span>, <span style=color:#e6db74>&#39;NPHI&#39;</span>, <span style=color:#e6db74>&#39;FORCE_2020_LITHOFACIES_LITHOLOGY&#39;</span>]]
</span></span></code></pre></div><p>To make things simpler we will rename the FORCE_2020_LITHOFACIES_LITHOLOGY column to just LITHOLOGY . This is done by using the rename function on the dataframe and passing a dictionary of the old name and the new name. Note that using the inplace=True argument will replace the column name in the original dataframe.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>data<span style=color:#f92672>.</span>rename(columns<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;FORCE_2020_LITHOFACIES_LITHOLOGY&#39;</span>:<span style=color:#e6db74>&#39;LITHOLOGY&#39;</span>}, inplace<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>data<span style=color:#f92672>.</span>head()
</span></span></code></pre></div><p>When we call upon our dataframe using data.head() we can see that our dataset is small and our lithology column has been renamed.</p><p><img src=https://cdn-images-1.medium.com/max/2000/1*V7fLIOX2b14Wzqmi9l-IuQ.png alt="The first five rows of our pandas dataframe containing Gamma Ray (GR), Bulk Density (RHOB), Neutron Porosity (NPHI) and Lithology."></p><h3 id=setting-up-the-lithologies-using-a-nested-dictionary>Setting up the Lithologies Using a Nested Dictionary</h3><p>The lithologies currently listed in the lithology column contain a series of numbers. We can map these in a nested dictionary where we have the full name of the lithology, a simplified number (if required for conversion), the hatch style, and the color of the fill.</p><p>The colors are based on the Kansas Geological Survey <a href=http://www.kgs.ku.edu/PRS/Ozark/PROFILE/HELP/DATA_ENTRY/lithology/Lithology-Symbols.html>website</a>. However, hatching symbols are limited in the default setup of matplotlib. In a future article, I will cover how to create custom hatches and lithologies.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>lithology_numbers <span style=color:#f92672>=</span> {<span style=color:#ae81ff>30000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Sandstone&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>: <span style=color:#e6db74>&#39;..&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#ffff00&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>65030</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Sandstone/Shale&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;-.&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#ffe119&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>65000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Shale&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;--&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#bebebe&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>80000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Marl&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>4</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#7cfc00&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>74000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Dolomite&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>5</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;-/&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#8080ff&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>70000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Limestone&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>6</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;+&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#80ffff&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>70032</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Chalk&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>7</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;..&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#80ffff&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>88000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Halite&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;x&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#7ddfbe&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>86000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Anhydrite&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>9</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#ff80ff&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>99000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Tuff&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>10</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;||&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#ff8c00&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>90000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Coal&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>11</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;black&#39;</span>},
</span></span><span style=display:flex><span>                 <span style=color:#ae81ff>93000</span>: {<span style=color:#e6db74>&#39;lith&#39;</span>:<span style=color:#e6db74>&#39;Basement&#39;</span>, <span style=color:#e6db74>&#39;lith_num&#39;</span>:<span style=color:#ae81ff>12</span>, <span style=color:#e6db74>&#39;hatch&#39;</span>:<span style=color:#e6db74>&#39;-|&#39;</span>, <span style=color:#e6db74>&#39;color&#39;</span>:<span style=color:#e6db74>&#39;#ef138a&#39;</span>}}
</span></span></code></pre></div><p>We can quickly convert our nested dictionary to a pandas dataframe to make it easier for humans to read by using the from_dict function like so.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>df_lith <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame<span style=color:#f92672>.</span>from_dict(lithology_numbers, orient<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;index&#39;</span>)
</span></span><span style=display:flex><span>df_lith<span style=color:#f92672>.</span>index<span style=color:#f92672>.</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LITHOLOGY&#39;</span>
</span></span><span style=display:flex><span>df_lith
</span></span></code></pre></div><p>This will return a nicely formatted table where we can see the colors and hatches for each lithology code.</p><p><img src=https://cdn-images-1.medium.com/max/2000/1*8c2u7UC9ivR1pmI1_An77w.png alt="A pandas dataframe generated from a nested dictionary."></p><p>By just looking at the dictionary, it can be difficult to understand how each of these will look. To solve this, we can quickly create a simple image showing the different hatchings and colors for each lithology.</p><p>To do this, we will first define some co-ordinates for two new variables x and y. Then we will setup the matplotlib figure and axes using subplots:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(ncols<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>, nrows<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, sharex<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, sharey<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, fig size<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>5</span>), subplot_kw<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;xticks&#39;</span>:[], <span style=color:#e6db74>&#39;yticks&#39;</span>:[]})
</span></span></code></pre></div><p>This allows us to define the size of the plot (4 columns by 3 rows), the figure size, and turning off the tick marks on both axes.</p><p>We then want to loop through the flattened axes and the nested dictionary to add the data and hatched color fills to each subplot. As we are dealing with a nested dictionary, we need to us square brackets multiple times [ ][ ] to go in two levels. The first level is the key, and the second level is the key of the nested dictionary. For example, to retrieve the color we can access it by typing in lithology_numbers[30000][&lsquo;color&rsquo;]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>y <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fig, axes <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(ncols<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>,nrows<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, sharex<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, sharey<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>                        figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>5</span>), subplot_kw<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;xticks&#39;</span>: [], <span style=color:#e6db74>&#39;yticks&#39;</span>: []})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ax, key <span style=color:#f92672>in</span> zip(axes<span style=color:#f92672>.</span>flat, lithology_numbers<span style=color:#f92672>.</span>keys()):
</span></span><span style=display:flex><span>   ax<span style=color:#f92672>.</span>plot(x, y)
</span></span><span style=display:flex><span>   ax<span style=color:#f92672>.</span>fill_betweenx(y, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, facecolor<span style=color:#f92672>=</span>lithology_numbers[key][<span style=color:#e6db74>&#39;color&#39;</span>], hatch<span style=color:#f92672>=</span>lithology_numbers[key][<span style=color:#e6db74>&#39;hatch&#39;</span>])
</span></span><span style=display:flex><span>   ax<span style=color:#f92672>.</span>set_xlim(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0.1</span>)
</span></span><span style=display:flex><span>   ax<span style=color:#f92672>.</span>set_ylim(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>   ax<span style=color:#f92672>.</span>set_title(str(lithology_numbers[key][<span style=color:#e6db74>&#39;lith&#39;</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>tight_layout()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p>This generates the following legend that we can refer to later on. Notice that the lithology symbols do not 100% match the Kansas Geological Survey chart. We will see how to resolve this in a future article.</p><p><img src=https://cdn-images-1.medium.com/max/3000/1*0tZaVbCGjs1Umeqd0EoUKg.png alt="Graphical representation using matplotlib of our colors and hatches. Image created by author."></p><h3 id=setting-up-the-well-log-plot-with-a-lithology-track>Setting up the Well Log Plot With a Lithology Track</h3><p>In previous articles (<a href=https://towardsdatascience.com/enhancing-visualization-of-well-logs-with-plot-fills-72d9dcd10c1b>Enhancing Visualization of Well Logs With Plot Fills</a> and <a href=https://towardsdatascience.com/exploratory-data-analysis-with-well-log-data-98ad084c4e7>Exploratory Data Analysis With Well Log Data</a>) I have set the plot up on the fly and passed in the dataframe I am working with. In this article, I will be creating a simple makeplot function which we can pass the dataframe into.</p><p>This allows us to easily reuse the code for other dataframes, assuming the curve names are the same. This could be further refined to make it more generic. This new function takes in three arguments, the dataframe, the top_depth, and the bottom depth.</p><p>This code will generate a well log plot with 3 tracks one for the Gamma Ray, one containing both Neutron Porosity and Bulk Density, and the final one containing our geological lithology data.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>makeplot</span>(well, top_depth, bottom_depth):
</span></span><span style=display:flex><span>    fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>15</span>,<span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#Set up the plot axes</span>
</span></span><span style=display:flex><span>    ax1 <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplot2grid((<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>3</span>), (<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>), rowspan<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, colspan <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    ax2 <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplot2grid((<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>3</span>), (<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>), rowspan<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, colspan <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, sharey <span style=color:#f92672>=</span> ax1)
</span></span><span style=display:flex><span>    ax3 <span style=color:#f92672>=</span> ax2<span style=color:#f92672>.</span>twiny() <span style=color:#75715e>#Twins the y-axis for the density track with the neutron track</span>
</span></span><span style=display:flex><span>    ax4 <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplot2grid((<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>3</span>), (<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>2</span>), rowspan<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, colspan <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, sharey <span style=color:#f92672>=</span> ax1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># As our curve scales will be detached from the top of the track,</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># this code adds the top border back in without dealing with splines</span>
</span></span><span style=display:flex><span>    ax10 <span style=color:#f92672>=</span> ax1<span style=color:#f92672>.</span>twiny()
</span></span><span style=display:flex><span>    ax10<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>set_visible(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    ax11 <span style=color:#f92672>=</span> ax2<span style=color:#f92672>.</span>twiny()
</span></span><span style=display:flex><span>    ax11<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>set_visible(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    ax13 <span style=color:#f92672>=</span> ax4<span style=color:#f92672>.</span>twiny()
</span></span><span style=display:flex><span>    ax13<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>set_visible(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Gamma Ray track</span>
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>plot(well[<span style=color:#e6db74>&#34;GR&#34;</span>], well[<span style=color:#e6db74>&#39;DEPTH_MD&#39;</span>], color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;green&#34;</span>, linewidth <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#34;Gamma&#34;</span>)
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>label<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>set_xlim(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>200</span>)
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>set_ylabel(<span style=color:#e6db74>&#34;Depth (m)&#34;</span>)
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>tick_params(axis<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;x&#39;</span>, colors<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>spines[<span style=color:#e6db74>&#34;top&#34;</span>]<span style=color:#f92672>.</span>set_edgecolor(<span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>title<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#39;green&#39;</span>)
</span></span><span style=display:flex><span>    ax1<span style=color:#f92672>.</span>set_xticks([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>200</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Density track</span>
</span></span><span style=display:flex><span>    ax2<span style=color:#f92672>.</span>plot(well[<span style=color:#e6db74>&#34;RHOB&#34;</span>], well[<span style=color:#e6db74>&#39;DEPTH_MD&#39;</span>], color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;red&#34;</span>, linewidth <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>    ax2<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#34;Density&#34;</span>)
</span></span><span style=display:flex><span>    ax2<span style=color:#f92672>.</span>set_xlim(<span style=color:#ae81ff>1.95</span>, <span style=color:#ae81ff>2.95</span>)
</span></span><span style=display:flex><span>    ax2<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>label<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#34;red&#34;</span>)
</span></span><span style=display:flex><span>    ax2<span style=color:#f92672>.</span>tick_params(axis<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;x&#39;</span>, colors<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;red&#34;</span>)
</span></span><span style=display:flex><span>    ax2<span style=color:#f92672>.</span>spines[<span style=color:#e6db74>&#34;top&#34;</span>]<span style=color:#f92672>.</span>set_edgecolor(<span style=color:#e6db74>&#34;red&#34;</span>)
</span></span><span style=display:flex><span>    ax2<span style=color:#f92672>.</span>set_xticks([<span style=color:#ae81ff>1.95</span>, <span style=color:#ae81ff>2.45</span>, <span style=color:#ae81ff>2.95</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Neutron track placed ontop of density track</span>
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>plot(well[<span style=color:#e6db74>&#34;NPHI&#34;</span>], well[<span style=color:#e6db74>&#39;DEPTH_MD&#39;</span>], color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;blue&#34;</span>, linewidth <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#39;Neutron&#39;</span>)
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>label<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>set_xlim(<span style=color:#ae81ff>0.45</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.15</span>)
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>tick_params(axis<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;x&#39;</span>, colors<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>spines[<span style=color:#e6db74>&#34;top&#34;</span>]<span style=color:#f92672>.</span>set_position((<span style=color:#e6db74>&#34;axes&#34;</span>, <span style=color:#ae81ff>1.08</span>))
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>spines[<span style=color:#e6db74>&#34;top&#34;</span>]<span style=color:#f92672>.</span>set_visible(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>spines[<span style=color:#e6db74>&#34;top&#34;</span>]<span style=color:#f92672>.</span>set_edgecolor(<span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>    ax3<span style=color:#f92672>.</span>set_xticks([<span style=color:#ae81ff>0.45</span>,  <span style=color:#ae81ff>0.15</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.15</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Lithology track</span>
</span></span><span style=display:flex><span>    ax4<span style=color:#f92672>.</span>plot(well[<span style=color:#e6db74>&#34;LITHOLOGY&#34;</span>], well[<span style=color:#e6db74>&#39;DEPTH_MD&#39;</span>], color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;black&#34;</span>, linewidth <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>    ax4<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#34;Lithology&#34;</span>)
</span></span><span style=display:flex><span>    ax4<span style=color:#f92672>.</span>set_xlim(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    ax4<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>label<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#34;black&#34;</span>)
</span></span><span style=display:flex><span>    ax4<span style=color:#f92672>.</span>tick_params(axis<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;x&#39;</span>, colors<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;black&#34;</span>)
</span></span><span style=display:flex><span>    ax4<span style=color:#f92672>.</span>spines[<span style=color:#e6db74>&#34;top&#34;</span>]<span style=color:#f92672>.</span>set_edgecolor(<span style=color:#e6db74>&#34;black&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> key <span style=color:#f92672>in</span> lithology_numbers<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>        color <span style=color:#f92672>=</span> lithology_numbers[key][<span style=color:#e6db74>&#39;color&#39;</span>]
</span></span><span style=display:flex><span>        hatch <span style=color:#f92672>=</span> lithology_numbers[key][<span style=color:#e6db74>&#39;hatch&#39;</span>]
</span></span><span style=display:flex><span>        ax4<span style=color:#f92672>.</span>fill_betweenx(well[<span style=color:#e6db74>&#39;DEPTH_MD&#39;</span>], <span style=color:#ae81ff>0</span>, well[<span style=color:#e6db74>&#39;LITHOLOGY&#39;</span>], where<span style=color:#f92672>=</span>(well[<span style=color:#e6db74>&#39;LITHOLOGY&#39;</span>]<span style=color:#f92672>==</span>key),
</span></span><span style=display:flex><span>                         facecolor<span style=color:#f92672>=</span>color, hatch<span style=color:#f92672>=</span>hatch)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ax4<span style=color:#f92672>.</span>set_xticks([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Common functions for setting up the plot can be extracted into</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># a for loop. This saves repeating code.</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ax <span style=color:#f92672>in</span> [ax1, ax2, ax4]:
</span></span><span style=display:flex><span>        ax<span style=color:#f92672>.</span>set_ylim(bottom_depth, top_depth)
</span></span><span style=display:flex><span>        ax<span style=color:#f92672>.</span>grid(which<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;major&#39;</span>, color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;lightgrey&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-&#39;</span>)
</span></span><span style=display:flex><span>        ax<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>set_ticks_position(<span style=color:#e6db74>&#34;top&#34;</span>)
</span></span><span style=display:flex><span>        ax<span style=color:#f92672>.</span>xaxis<span style=color:#f92672>.</span>set_label_position(<span style=color:#e6db74>&#34;top&#34;</span>)
</span></span><span style=display:flex><span>        ax<span style=color:#f92672>.</span>spines[<span style=color:#e6db74>&#34;top&#34;</span>]<span style=color:#f92672>.</span>set_position((<span style=color:#e6db74>&#34;axes&#34;</span>, <span style=color:#ae81ff>1.02</span>))
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> ax <span style=color:#f92672>in</span> [ax2, ax3, ax4]:
</span></span><span style=display:flex><span>        plt<span style=color:#f92672>.</span>setp(ax<span style=color:#f92672>.</span>get_yticklabels(), visible <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>tight_layout()
</span></span><span style=display:flex><span>    fig<span style=color:#f92672>.</span>subplots_adjust(wspace <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.15</span>)
</span></span></code></pre></div><p>The key piece of code to ensure our lithology fill_betweenx function from matplotlib creates a variable fill is shown below. All we are doing is looping over each of the keys within the dictionary, assigning simpler variable names to the features within the dictionary, and then using the fill_betweenx function to check if the value in our lithology column equals the dictionary key. If it does, then it will apply the relevant color and hatching to the fill. It will then move on to the next key and repeat until all keys have been cycled through.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> key <span style=color:#f92672>in</span> lithology_numbers<span style=color:#f92672>.</span>keys():
</span></span><span style=display:flex><span>    color <span style=color:#f92672>=</span> lithology_numbers[key][<span style=color:#e6db74>&#39;color&#39;</span>]
</span></span><span style=display:flex><span>    hatch <span style=color:#f92672>=</span> lithology_numbers[key][<span style=color:#e6db74>&#39;hatch&#39;</span>]
</span></span><span style=display:flex><span>    ax4<span style=color:#f92672>.</span>fill_betweenx(well[<span style=color:#e6db74>&#39;DEPTH_MD&#39;</span>], <span style=color:#ae81ff>0</span>, well[<span style=color:#e6db74>&#39;LITHOLOGY&#39;</span>], 
</span></span><span style=display:flex><span>                      where<span style=color:#f92672>=</span>(well[<span style=color:#e6db74>&#39;LITHOLOGY&#39;</span>]<span style=color:#f92672>==</span>key),
</span></span><span style=display:flex><span>                      facecolor<span style=color:#f92672>=</span>color, hatch<span style=color:#f92672>=</span>hatch)
</span></span></code></pre></div><h3 id=displaying-the-well-log-plot--lithology>Displaying the Well Log Plot & Lithology</h3><p>Once we have the plot set up as a function. We can simply pass in our dataframe and the depths that we want to plot. In this example, we will focus on a small section of the data so that we are able to see the change in the plot fills.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>makeplot(data, <span style=color:#ae81ff>2600</span>, <span style=color:#ae81ff>3100</span>)
</span></span></code></pre></div><p>Once we do this, the plot below will appear.</p><p><img src=https://cdn-images-1.medium.com/max/4500/1*-pxzLmkbuzwxnWXOp8ALRA.png alt="Well log plot generated by matplotlib with geological lithology data covering 2600 to 3100m. Image created by the author."></p><p>To see the lithology fill in more detail, we can zoom in by changing the depth range values.</p><p><img src=https://cdn-images-1.medium.com/max/4500/1*i6Kdqh3tQHy-49-z56n6LQ.png alt="Well log plot generated by matplotlib with geological lithology data covering 2900 to 3100m. Image created by the author."></p><h2 id=summary>Summary</h2><p>In this article we have covered how to setup and display lithology data using matplotlib’s fill_betweenx() function. We saw how a nested dictionary can be used to store parameters for each lithology and then be called upon using a for loop to fill with the correct color and hatch.</p><p>Adding this data to a plot can enhance how the geoscientist or petrophysicist relates the electrical logging measurements to the geology.</p><p><em><strong>Thanks for reading!</strong></em></p><p><em>If you have found this article useful, please feel free to check out my other articles looking at various aspects of Python and well log data. You can also find my code used in this article and others at <a href=https://github.com/andymcdgeo>GitHub</a>.</em></p><p><em>If you want to get in touch you can find me on <a href=https://www.linkedin.com/in/andymcdonaldgeo/>LinkedIn</a> or at my <a href=http://andymcdonald.scot/>website</a>.</em></p><p><em>Interested in learning more about python and well log data or petrophysics? Follow me on <a href=https://medium.com/@andymcdonaldgeo>Medium</a>.</em></p><p>If you have enjoyed this article or any others and want to show your appreciation you are welcome to <a href=http://buymeacoffee.com/andymcdonaldgeo>Buy Me a Coffee</a></p><h2 id=references>References</h2><p>Kansas Geological Survey, Lithology Symbols. <a href=http://www.kgs.ku.edu/PRS/Ozark/PROFILE/HELP/DATA_ENTRY/lithology/Lithology-Symbols.html>http://www.kgs.ku.edu/PRS/Ozark/PROFILE/HELP/DATA_ENTRY/lithology/Lithology-Symbols.html</a></p><p>“Lithofacies data was provided by the FORCE Machine Learning competition with well logs and seismic 2020” Bormann P., Aursand P., Dilib F., Dischington P., Manral S. 2020. 2020 FORCE Machine Learning Contest. <a href=https://github.com/bolgebrygg/Force-2020-Machine-Learning-competition>https://github.com/bolgebrygg/Force-2020-Machine-Learning-competition</a></p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=https://www.andymcdonald.scot/tags/petrophysics/>petrophysics</a>
<a class="tag tag--primary tag--small" href=https://www.andymcdonald.scot/tags/python/>python</a>
<a class="tag tag--primary tag--small" href=https://www.andymcdonald.scot/tags/lithology/>lithology</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://www.andymcdonald.scot/blog/2021/2021-02-14-loading-multiple-well-log-las-files-using-python/ data-tooltip="Loading Multiple Well Log LAS Files Using Python" aria-label="NEXT: Loading Multiple Well Log LAS Files Using Python"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://www.andymcdonald.scot/blog/2021/2021-01-31-displaying-logging-while-drill-lwd-image-logs-in-python/ data-tooltip="Displaying Logging While Drilling Image Data on a Well Log Plot Using Python" aria-label="PREVIOUS: Displaying Logging While Drilling Image Data on a Well Log Plot Using Python"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#disqus_thread aria-label="Leave a comment"><i class="far fa-comment"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div><div id=disqus_thread><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div><script type=text/javascript>var disqus_config=function(){this.page.url="https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/",this.page.identifier="/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/"};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="hugo-tranquilpeak-theme",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2022 Andy McDonald. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=2><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://www.andymcdonald.scot/blog/2021/2021-02-14-loading-multiple-well-log-las-files-using-python/ data-tooltip="Loading Multiple Well Log LAS Files Using Python" aria-label="NEXT: Loading Multiple Well Log LAS Files Using Python"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://www.andymcdonald.scot/blog/2021/2021-01-31-displaying-logging-while-drill-lwd-image-logs-in-python/ data-tooltip="Displaying Logging While Drilling Image Data on a Well Log Plot Using Python" aria-label="PREVIOUS: Displaying Logging While Drilling Image Data on a Well Log Plot Using Python"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.andymcdonald.scot/blog/2021/2021-02-07-displaying-lithology-on-log-plots-using-python/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#disqus_thread aria-label="Leave a comment"><i class="far fa-comment"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=2><i id=btn-close-shareoptions class="fa fa-times"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.andymcdonald.scot%2Fblog%2F2021%2F2021-02-07-displaying-lithology-on-log-plots-using-python%2F" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fwww.andymcdonald.scot%2Fblog%2F2021%2F2021-02-07-displaying-lithology-on-log-plots-using-python%2F" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.andymcdonald.scot%2Fblog%2F2021%2F2021-02-07-displaying-lithology-on-log-plots-using-python%2F" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i><span>Share on Linkedin</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><img id=about-card-picture src=https://www.andymcdonald.scot/images/andy2.png alt="Author's picture"><h4 id=about-card-name>Andy McDonald</h4><div id=about-card-bio>Super bio with markdown support <strong>COOL</strong></div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Petrophysicist, Geoscientist, Data Scientist</div><div id=about-card-location><i class="fa fa-map-marker-alt"></i><br>Scotland</div></div></div><div id=cover style=background-image:url(https://www.andymcdonald.scot/images/massimo-botturi-zFYUsLk_50Y-unsplash.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://www.andymcdonald.scot/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-gE8KAQyFIzV1C9+GZ8TKJHZS2s+n7EjNtC+IMRn1l5+WYJTHOODUM6JSjZhFhqXmc7bG8Av6XXpckA4tYhflnw==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/apache.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-EWROca+bote+7Oaaar1F6y74iZj1r1F9rm/ly7o+/FwJopbBaWtsFDmaKoZDd3QiGU2pGacBirHJNivmGLYrow==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/go.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-GDVzAn0wpx1yVtQsRWmFc6PhJiLBPdUic+h4GWgljBh904O3JU10fk9EKNpVyIoPqkFn54rgL2QBG4BmUTMpiQ==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/http.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-UgZlma8NzkrDb/NWgmLIcTrH7i/CSnLLDRFqCSNF5NGPpjKmzyM25qcoXGOup8+cDakKyaiTDd7N4dyH4YT+IA==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/less.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-lot9koe73sfXIrUvIPM/UEhuMciN56RPyBdOyZgfO53P2lkWyyXN7J+njcxIIBRV+nVDQeiWtiXg+bLAJZDTfg==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/nginx.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-Zd3e7XxHP00TD0Imr0PIfeM0fl0v95kMWuhyAS3Wn1UTSXTkz0OhtRgBAr4JlmADRgiXr4x7lpeUdqaGN8xIog==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/puppet.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-qtqDO052iXMSP+5d/aE/jMtL9vIIGvONgTJziC2K/ZIB1yEGa55WVxGE9/08rSQ62EoDifS9SWVGZ7ihSLhzMA==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/scss.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-1NmkjnEDnwwwcu28KoQF8vs3oaPFokQHbmbtwGhFfeDsQZtVFI8zW2aE9O8yMYdpdyKV/5blE4pSWw4Z/Sv97w==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/stylus.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-B2wSfruPjr8EJL6IIzQr1eAuDwrsfIfccNf/LCEdxELCgC/S/ZMt/Uvk80aD79m7IqOqW+Sw8nbkvha20yZpzg==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/swift.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-28oDiQZGKUVN6wQ7PSLPNipOcmkCALXKwOi7bnkyFf8QiMZQxG9EQoy/iiNx6Zxj2cG2SbVa4dXKigQhu7GiFw==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/yaml.min.js></script>
<script>$(document).ready(function(){hljs.configure({classPrefix:'',useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(t,e){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(e)})})</script></body></html>