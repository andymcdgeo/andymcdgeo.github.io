<!doctype html><html lang=en-us><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"Website","@id":"https:\/\/www.andymcdonald.scot\/","author":{"@type":"Person","name":"Andy McDonald","image":"https://www.andymcdonald.scot/images/andy2.png"},"name":"Andy McDonald","description":"Normalization of well log data is a common and routine process within a petrophysical workflow and is used to correct for variations in logging curves between wells. These variations can arise due a number of different reasons such as incorrect tool calibrations, varying tool vintage and changes in borehole environmental conditions between the wells.\nIn this article we will go over:\n  What normalization is\n  Why we want to normalize well log data","url":"https:\/\/www.andymcdonald.scot\/blog\/2020\/2020-10-18-petrophysics-gamma-ray-normalisation-in-python\/","keywords":"[]"}</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.98.0 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content="Andy McDonald"><meta name=keywords content><meta name=description content="Normalization of well log data is a common and routine process within a petrophysical workflow and is used to correct for variations in logging curves between wells. These variations can arise due a number of different reasons such as incorrect tool calibrations, varying tool vintage and changes in borehole environmental conditions between the wells.
In this article we will go over:
  What normalization is
  Why we want to normalize well log data"><meta property="og:description" content="Normalization of well log data is a common and routine process within a petrophysical workflow and is used to correct for variations in logging curves between wells. These variations can arise due a number of different reasons such as incorrect tool calibrations, varying tool vintage and changes in borehole environmental conditions between the wells.
In this article we will go over:
  What normalization is
  Why we want to normalize well log data"><meta property="og:type" content="article"><meta property="og:title" content="Petrophysics: Gamma Ray Normalization in Python"><meta name=twitter:title content="Petrophysics: Gamma Ray Normalization in Python"><meta property="og:url" content="https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/"><meta property="twitter:url" content="https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/"><meta property="og:site_name" content="Andy McDonald"><meta property="og:description" content="Normalization of well log data is a common and routine process within a petrophysical workflow and is used to correct for variations in logging curves between wells. These variations can arise due a number of different reasons such as incorrect tool calibrations, varying tool vintage and changes in borehole environmental conditions between the wells.
In this article we will go over:
  What normalization is
  Why we want to normalize well log data"><meta name=twitter:description content="Normalization of well log data is a common and routine process within a petrophysical workflow and is used to correct for variations in logging curves between wells. These variations can arise due a number of different reasons such as incorrect tool calibrations, varying tool vintage and changes in borehole environmental conditions between the wells.
In this article we will go over:
  What normalization is
  Why we want to normalize well log data"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2020-10-18T00:00:00"><meta property="article:modified_time" content="2020-10-18T00:00:00"><meta property="article:section" content="Petrophysics"><meta property="article:section" content="Python"><meta property="article:section" content="Data Quality"><meta property="article:tag" content="petrophysics"><meta property="article:tag" content="python"><meta property="article:tag" content="normalisation"><meta name=twitter:card content="summary"><meta property="og:image" content="https://www.andymcdonald.scot/images/andy2.png"><meta property="twitter:image" content="https://www.andymcdonald.scot/images/andy2.png"><title>Petrophysics: Gamma Ray Normalization in Python</title><link rel=icon href=https://www.andymcdonald.scot/favicon.png><link rel=canonical href=https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://www.andymcdonald.scot/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css></head><body><div id=blog><header id=header data-behavior=2><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=https://www.andymcdonald.scot/ aria-label="Go to homepage">Andy McDonald</a></div><a class=header-right-picture href=https://www.andymcdonald.scot/#about aria-label="Open the link: /#about"><img class=header-picture src=https://www.andymcdonald.scot/images/andy2.png alt="Author's picture"></a></header><nav id=sidebar data-behavior=2><div class=sidebar-container><div class=sidebar-profile><a href=https://www.andymcdonald.scot/#about aria-label="Read more about the author"><img class=sidebar-profile-picture src=https://www.andymcdonald.scot/images/andy2.png alt="Author's picture"></a><h4 class=sidebar-profile-name>Andy McDonald</h4><h5 class=sidebar-profile-bio>Super bio with markdown support <strong>COOL</strong></h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/about title=About><i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden=true></i>
<span class=sidebar-button-desc>About</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/blog title=Blog><i class="sidebar-button-icon fas fa-lg fa-server" aria-hidden=true></i>
<span class=sidebar-button-desc>Blog</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/published_work title=Publications><i class="sidebar-button-icon fas fa-lg fa-book" aria-hidden=true></i>
<span class=sidebar-button-desc>Publications</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/categories title=Categories><i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden=true></i>
<span class=sidebar-button-desc>Categories</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>Tags</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/andymcdgeo target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.linkedin.com/in/andymcdonaldgeo/ target=_blank rel=noopener title=LinkedIn><i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden=true></i>
<span class=sidebar-button-desc>LinkedIn</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://medium.com/@andymcdonaldgeo target=_blank rel=noopener title=Medium><i class="sidebar-button-icon fab fa-lg fa-medium" aria-hidden=true></i>
<span class=sidebar-button-desc>Medium</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.youtube.com/c/AndyMcDonald42 target=_blank rel=noopener title=YouTube><i class="sidebar-button-icon fab fa-lg fa-youtube" aria-hidden=true></i>
<span class=sidebar-button-desc>YouTube</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://www.andymcdonald.scot/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div></nav><div id=main data-behavior=2 class=hasCoverMetaIn><article class=post id=top><div class="post-header main-content-wrap text-left"><h1 class=post-title>Petrophysics: Gamma Ray Normalization in Python</h1><div class="postShorten-meta post-meta"><time datetime=2020-10-18T00:00:00Z>October 18, 2020</time>
<span>in</span>
<a class=category-link href=https://www.andymcdonald.scot/categories/petrophysics>Petrophysics</a>,
<a class=category-link href=https://www.andymcdonald.scot/categories/python>Python</a>,
<a class=category-link href=https://www.andymcdonald.scot/categories/data-quality>Data Quality</a></div></div><div class="post-content markdown"><div class=main-content-wrap><p>Normalization of well log data is a common and routine process within a petrophysical workflow and is used to correct for variations in logging curves between wells. These variations can arise due a number of different reasons such as incorrect tool calibrations, varying tool vintage and changes in borehole environmental conditions between the wells.</p><p>In this article we will go over:</p><ul><li><p>What normalization is</p></li><li><p>Why we want to normalize well log data</p></li><li><p>How we carry out normalization</p></li><li><p>Example of normalization within Python</p></li></ul><h3 id=what-is-normalization>What is normalization?</h3><p>Normalization is the process of re-scaling or re-calibrating the well logs so that they are consistent with other logs in other wells within the field or region. This can be achieved by applying a single point normalization (linear shift) or a two point normalization (‘stretch and squeeze’) to the required curve.</p><p>Normalization is commonly applied to gamma ray logs, but can be applied to neutron porosity, bulk density, sonic and spontaneous potential logs as well. Resistivity logs are generally not normalized unless there is a sufficient reason to do so (Shier, 2004).</p><p>You should discuss with your stratigrapher/geologist prior to carrying out normalization and also carry out a thorough QC of your data to understand if it is necessary. <strong>Applying normalization blindly to your data can result in geological variation and features being removed from the data. Therefore, it should be considered carefully.</strong> Shier (2004) provides an excellent discussion and guidelines on how to carry out normalization on well log data and is well worth reviewing.</p><h3 id=why-do-we-want-to-normalize-our-well-log-data>Why do we want to normalize our well log data?</h3><p>Within a region, it is commonly assumed that similar geological and stratigraphical units should show similar minimum and maximum log values and also similar log responses. However, there are a multitude of reasons why the log responses may differ from the expected pattern between the logged wells. These can include:</p><ul><li><p>Differences in borehole environment such as lithological variations</p></li><li><p>Differences in wellbore shape affecting the measurements, for example an enlarged section of the borehole will have more borehole fluid in it and this can lead to an attenuation of gamma ray logs, which in turn leads to a reduction in values</p></li><li><p>Incorrectly applied tool calibrations</p></li><li><p>Variations in logging tool technology and sensors through time</p></li><li><p>Diagenetic changes to the rock</p></li><li><p>Drift in the tool responses</p></li><li><p>Different tools from multiple service companies</p></li></ul><p>Carrying out normalization allows us to make useful comparisons between multiple wells. It also makes batch processing more efficient, especially when selecting key interpretation parameters.</p><p>Additionally, normalization can be applied to data even if that data has been previously borehole corrected (Shier, 2004). This is useful when working with datasets where there is no knowledge of what corrections have been applied, especially in older datasets.</p><h3 id=how-do-we-normalize-well-log-data>How do we normalize well log data?</h3><p>The workflow for normalization usually involves selecting a key well within the region or field and selecting key parameters from it and re-scaling other wells to match.</p><p>Normalization can be carried out using a simple linear shift of the log data using the equation below. This is useful where we know we have a fixed shift in the data such as when neutron porosity has been recorded in different lithology units (Crain’s Petrophysics, 2020).</p><p><img src=https://cdn-images-1.medium.com/max/2000/1*1sEuscJTTBu0apWd0vyR2A.png alt></p><p>More commonly a two-point shift is applied, whereby the data is stretched and squeezed to match the reference well. This is is frequently applied to gamma ray data. This is calculated as follows:</p><p><img src=https://cdn-images-1.medium.com/max/2000/1*gfZWSfll3zSSu1TYeqKlJg.png alt></p><p>The key parameters — which are selected from the reference / key well — can be the minimum or maximum values. More commonly they are values obtained from percentiles such as the 5th and 95th percentile. If using the minimum and maximum values you need to be wary of outliers and anomalous readings. For example, if the gamma ray in the reference well read a single value of 600 API and it was used as a reference maximum value it would stretch out the other wells being normalized to this range.</p><h2 id=normalization-example-using-python>Normalization Example Using Python</h2><p>The following code walkthrough shows one way of normalizing well log data using a pandas dataframe and three wells from the Volve Dataset (Equinor, 2018).</p><p>You can find the full Jupyter Notebook for this example within **8 — Curve Normalisation.ipynb **of my Petrophysics and Python series on GitHub at the following link:
<a href=https://github.com/andymcdgeo/Petrophysics-Python-Series/><strong>andymcdgeo/Petrophysics-Python-Series</strong>
*This series of Jupyter Notebooks take you through various aspects of working with Python and Petrophysical data.*github.com</a></p><h3 id=setting-up-the-libraries-and-loading-data>Setting up The Libraries and Loading Data</h3><p>The first step is to import the required libraries that we plan to use. In this case it will be the pandas and matplotlib libraries.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    <span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>    <span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span></code></pre></div><p>We can load in our data straight from CSV. In this example I am using a subset of 3 wells from the Volve dataset.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    data <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;Data/VolveWells.csv&#39;</span>)
</span></span></code></pre></div><p>We can then obtain details about the data with a few simple commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    data<span style=color:#f92672>.</span>head()
</span></span></code></pre></div><p>This returns the column headers and the first 5 rows of the data:</p><p><img src=https://cdn-images-1.medium.com/max/2000/1*F7dWp9_VioPqutc9hNONuw.png alt></p><p>We can see right away what curves we have in this dataset and that the nulls are represented by NaN (Not a Number) values. Which is good and means we don’t need to replace values.</p><p>To check what wells we have in the data we can call upon the unique() method:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    data[<span style=color:#e6db74>&#39;WELL&#39;</span>]<span style=color:#f92672>.</span>unique()
</span></span></code></pre></div><p>This will return an array of the well names like so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    array([<span style=color:#e6db74>&#39;15/9-F-1 C&#39;</span>, <span style=color:#e6db74>&#39;15/9-F-4&#39;</span>, <span style=color:#e6db74>&#39;15/9-F-7&#39;</span>], dtype<span style=color:#f92672>=</span>object)
</span></span></code></pre></div><p>From this initial exploration we can say that we have:</p><ul><li><p>3 wells within the dataset: 15/9-F-1 C, 15/9-F-4 and 15/9-F-7</p></li><li><p>There is no need to replace any -999 values as nulls</p></li><li><p>10 logging curves in each well</p></li></ul><h3 id=plotting-the-raw-data>Plotting the Raw Data</h3><p>Before we plot the data, the first step we need to do is group the dataframe by the WELL column. This will make it easier to plot on the histogram.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    wells <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;WELL&#39;</span>)
</span></span><span style=display:flex><span>    wells<span style=color:#f92672>.</span>head()
</span></span></code></pre></div><p>We can see if we call upon wells.head() we get a grouped dataframe showing the first 5 rows from each well.</p><p><img src=https://cdn-images-1.medium.com/max/2000/1*hgLj2gF8U_udVQVDtis5_g.png alt></p><p>One of the easiest ways to compare the distribution and select key parameters is by using a histogram. In Python, if we want to see the distribution line rather than bars we have to call upon the Kernel Density Estimation (KDE) plot as opposed to the histogram. Using our grouped dataframe allows us to loop through each well, add the data to the plot and display the correct label in the legend:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> label, df <span style=color:#f92672>in</span> wells:
</span></span><span style=display:flex><span>        df<span style=color:#f92672>.</span>GR<span style=color:#f92672>.</span>plot(kind <span style=color:#f92672>=</span><span style=color:#e6db74>&#39;kde&#39;</span>, ax<span style=color:#f92672>=</span>ax, label<span style=color:#f92672>=</span>label)
</span></span><span style=display:flex><span>        plt<span style=color:#f92672>.</span>xlim(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>200</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>legend()
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p><img src=https://cdn-images-1.medium.com/max/4800/1*buX1ViCXtJMF82s6KTzKIw.png alt></p><p>From the plot above, we will assume that the key well is 15/9-F-7 and we will normalize the other two wells to this one.</p><p>Note that it does appear that the distributions run off the left hand side of the plot, but it can be confirmed using the min() method no values exist below 0 for the gamma ray curve:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    wells<span style=color:#f92672>.</span>min()
</span></span></code></pre></div><p><img src=https://cdn-images-1.medium.com/max/2000/1*ToPigwdv_dLihjIVBXvDZg.png alt></p><h3 id=calculating-the-percentiles>Calculating the Percentiles</h3><p>As mentioned above, it is possible that datasets can contain erroneous values which may affect the minimum and the maximum values within a curve. Therefore, some interpreters prefer to base their normalization parameters on percentiles. In this example, I am going to use the 5th and 95th percentiles.</p><p>The first step is to calculate the percentile (or quantile as pandas refers to it) by grouping the data by wells and then applying the .quantile() method to a specific column. In this case, GR. The quantile function takes in a decimal value, so a value of 0.05 is equivalent to the 5th percentile and 0.95 is equivalent to the 95th percentile.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    gr_percentile_05 <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;WELL&#39;</span>)[<span style=color:#e6db74>&#39;GR&#39;</span>]<span style=color:#f92672>.</span>quantile(<span style=color:#ae81ff>0.05</span>)
</span></span><span style=display:flex><span>    print(gr_percentile_05)
</span></span></code></pre></div><p>So now we need to bring that back into our main dataframe. We can do this using the .map() method, which will combine two data series that share a common column. Once it is mapped we can call upon the .describe() method and confirm that it has been added to the dataframe.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    data[<span style=color:#e6db74>&#39;05_PERC&#39;</span>] <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#39;WELL&#39;</span>]<span style=color:#f92672>.</span>map(gr_percentile_05)
</span></span><span style=display:flex><span>    data<span style=color:#f92672>.</span>describe()
</span></span></code></pre></div><p>We can see that the 5th percentile data we calculated above has now been added to the end of the dataframe. We can now repeat the above process for the 95th percentile:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    gr_percentile_95 <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;WELL&#39;</span>)[<span style=color:#e6db74>&#39;GR&#39;</span>]<span style=color:#f92672>.</span>quantile(<span style=color:#ae81ff>0.95</span>)
</span></span><span style=display:flex><span>    data[<span style=color:#e6db74>&#39;95_PERC&#39;</span>] <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#39;WELL&#39;</span>]<span style=color:#f92672>.</span>map(gr_percentile_95)
</span></span><span style=display:flex><span>    data<span style=color:#f92672>.</span>describe()
</span></span></code></pre></div><h3 id=creating-the-normalization-function>Creating the Normalization Function</h3><p>Before we normalize our data, we must first create a function that can be called upon multiple times. As a reminder, the function we are using is as follows (Shier, 2004):</p><p><img src=https://cdn-images-1.medium.com/max/2000/1*oE88y-PcZxT1Pq3zwN3png.png alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>normalise</span>(curve, ref_low, ref_high, well_low, well_high):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> ref_low <span style=color:#f92672>+</span> ((ref_high <span style=color:#f92672>-</span> ref_low) <span style=color:#f92672>*</span> ((curve <span style=color:#f92672>-</span> well_low) <span style=color:#f92672>/</span> (well_high <span style=color:#f92672>-</span> well_low)))
</span></span></code></pre></div><p>Using the percentiles calculated in the previous step, we can set our reference high and low values:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    key_well_low <span style=color:#f92672>=</span> <span style=color:#ae81ff>25.6464</span>
</span></span><span style=display:flex><span>    key_well_high <span style=color:#f92672>=</span> <span style=color:#ae81ff>110.5413</span>
</span></span></code></pre></div><p>To apply the function to each value and use the correct percentiles for each well we can use the .apply() method to the pandas dataframe and then a lamda function for our custom function.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    data[<span style=color:#e6db74>&#39;GR_NORM&#39;</span>] <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: normalise(x[<span style=color:#e6db74>&#39;GR&#39;</span>], key_well_low, key_well_high, x[<span style=color:#e6db74>&#39;05_PERC&#39;</span>], x[<span style=color:#e6db74>&#39;95_PERC&#39;</span>]), axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span></code></pre></div><h3 id=plotting-the-normalized-data>Plotting the Normalized Data</h3><p>To view our final normalized data, we can re-use the code from above to generate the histogram. When we do, we can see that all curves have been normalized to our reference well.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> label, df <span style=color:#f92672>in</span> wells:
</span></span><span style=display:flex><span>        df<span style=color:#f92672>.</span>GR_NORM<span style=color:#f92672>.</span>plot(kind <span style=color:#f92672>=</span><span style=color:#e6db74>&#39;kde&#39;</span>, ax<span style=color:#f92672>=</span>ax, label<span style=color:#f92672>=</span>label)
</span></span><span style=display:flex><span>        plt<span style=color:#f92672>.</span>xlim(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>200</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>legend()
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><p>We now have our normalized gamma ray data. When compared side by side we can see the difference the normalization has made to the data.</p><p><img src=https://cdn-images-1.medium.com/max/10102/1*gcbb6EF_p0wOyPKimpDDDg.png alt></p><h2 id=conclusion>Conclusion</h2><p>Normalization of well log curves is an important step within the petrophysical workflow and can be required for a variety of reasons including: poor tool calibrations, varying tool vintages, lithological differences, and borehole environmental conditions.</p><p>Carrying out normalization allows easier comparison between multiple wells and easier selection of key interpretation parameters when carrying out batch processing.</p><p>In this article we have covered how to carry out a simple normalization of a gamma ray log using Python. But the method can equally be applied to other well logs with the usual caveats that the data would need to be sense checked afterwards.</p><h2 id=references>References</h2><p>Crains Petrophysical Handbook (2020). Available at: <a href=https://www.spec2000.net/08-normalization.htm>https://www.spec2000.net/08-normalization.htm</a></p><p>Equinor. (2018). Disclosing all Volve data. Available at: <a href=https://www.equinor.com/en/news/14jun2018-disclosing-volve-data.html>https://www.equinor.com/en/news/14jun2018-disclosing-volve-data.html</a></p><p>Shier, D. E. (2004). Well log normalization: Methods and guidelines. Petrophysics, 45(3), 268–280.</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=https://www.andymcdonald.scot/tags/petrophysics/>petrophysics</a>
<a class="tag tag--primary tag--small" href=https://www.andymcdonald.scot/tags/python/>python</a>
<a class="tag tag--primary tag--small" href=https://www.andymcdonald.scot/tags/normalisation/>normalisation</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://www.andymcdonald.scot/blog/2020/2020-10-26-visualising-well-data-coverage-using-matplotlib/ data-tooltip="Visualising Well Data Coverage Using matplotlib" aria-label="NEXT: Visualising Well Data Coverage Using matplotlib"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://www.andymcdonald.scot/blog/2020/2020-08-30-loading-and-displaying-well-log-data-from-las-files-with-python/ data-tooltip="Loading and Displaying Well Log Data from LAS Files with Python" aria-label="PREVIOUS: Loading and Displaying Well Log Data from LAS Files with Python"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#disqus_thread aria-label="Leave a comment"><i class="far fa-comment"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div><div id=disqus_thread><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div><script type=text/javascript>var disqus_config=function(){this.page.url="https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/",this.page.identifier="/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/"};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="hugo-tranquilpeak-theme",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2022 Andy McDonald. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=2><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://www.andymcdonald.scot/blog/2020/2020-10-26-visualising-well-data-coverage-using-matplotlib/ data-tooltip="Visualising Well Data Coverage Using matplotlib" aria-label="NEXT: Visualising Well Data Coverage Using matplotlib"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://www.andymcdonald.scot/blog/2020/2020-08-30-loading-and-displaying-well-log-data-from-las-files-with-python/ data-tooltip="Loading and Displaying Well Log Data from LAS Files with Python" aria-label="PREVIOUS: Loading and Displaying Well Log Data from LAS Files with Python"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.andymcdonald.scot/blog/2020/2020-10-18-petrophysics-gamma-ray-normalisation-in-python/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#disqus_thread aria-label="Leave a comment"><i class="far fa-comment"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=2><i id=btn-close-shareoptions class="fa fa-times"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.andymcdonald.scot%2Fblog%2F2020%2F2020-10-18-petrophysics-gamma-ray-normalisation-in-python%2F" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fwww.andymcdonald.scot%2Fblog%2F2020%2F2020-10-18-petrophysics-gamma-ray-normalisation-in-python%2F" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.andymcdonald.scot%2Fblog%2F2020%2F2020-10-18-petrophysics-gamma-ray-normalisation-in-python%2F" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i><span>Share on Linkedin</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><img id=about-card-picture src=https://www.andymcdonald.scot/images/andy2.png alt="Author's picture"><h4 id=about-card-name>Andy McDonald</h4><div id=about-card-bio>Super bio with markdown support <strong>COOL</strong></div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Petrophysicist, Geoscientist, Data Scientist</div><div id=about-card-location><i class="fa fa-map-marker-alt"></i><br>Scotland</div></div></div><div id=cover style=background-image:url(https://www.andymcdonald.scot/images/massimo-botturi-zFYUsLk_50Y-unsplash.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://www.andymcdonald.scot/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-gE8KAQyFIzV1C9+GZ8TKJHZS2s+n7EjNtC+IMRn1l5+WYJTHOODUM6JSjZhFhqXmc7bG8Av6XXpckA4tYhflnw==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/apache.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-EWROca+bote+7Oaaar1F6y74iZj1r1F9rm/ly7o+/FwJopbBaWtsFDmaKoZDd3QiGU2pGacBirHJNivmGLYrow==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/go.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-GDVzAn0wpx1yVtQsRWmFc6PhJiLBPdUic+h4GWgljBh904O3JU10fk9EKNpVyIoPqkFn54rgL2QBG4BmUTMpiQ==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/http.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-UgZlma8NzkrDb/NWgmLIcTrH7i/CSnLLDRFqCSNF5NGPpjKmzyM25qcoXGOup8+cDakKyaiTDd7N4dyH4YT+IA==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/less.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-lot9koe73sfXIrUvIPM/UEhuMciN56RPyBdOyZgfO53P2lkWyyXN7J+njcxIIBRV+nVDQeiWtiXg+bLAJZDTfg==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/nginx.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-Zd3e7XxHP00TD0Imr0PIfeM0fl0v95kMWuhyAS3Wn1UTSXTkz0OhtRgBAr4JlmADRgiXr4x7lpeUdqaGN8xIog==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/puppet.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-qtqDO052iXMSP+5d/aE/jMtL9vIIGvONgTJziC2K/ZIB1yEGa55WVxGE9/08rSQ62EoDifS9SWVGZ7ihSLhzMA==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/scss.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-1NmkjnEDnwwwcu28KoQF8vs3oaPFokQHbmbtwGhFfeDsQZtVFI8zW2aE9O8yMYdpdyKV/5blE4pSWw4Z/Sv97w==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/stylus.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-B2wSfruPjr8EJL6IIzQr1eAuDwrsfIfccNf/LCEdxELCgC/S/ZMt/Uvk80aD79m7IqOqW+Sw8nbkvha20yZpzg==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/swift.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-28oDiQZGKUVN6wQ7PSLPNipOcmkCALXKwOi7bnkyFf8QiMZQxG9EQoy/iiNx6Zxj2cG2SbVa4dXKigQhu7GiFw==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/yaml.min.js></script>
<script>$(document).ready(function(){hljs.configure({classPrefix:'',useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(t,e){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(e)})})</script></body></html>